model Asignatura {
  id     Int    @id @default(autoincrement())
  codigo String @unique

  nombre String

  descripcion String?
  unidad      String?

  linkSyllabus String?

  // es referenciado por

  PlanContemplaAsignatura PlanContemplaAsignatura[] @relation(name: "contempla la asignatura")
}

enum CARACTER {
  NORMAL
  ELECTIVO
  PRACTICA
  TITULACION
}

enum AREA {
  FP
  FG
  FE
  FB
}

model PlanContemplaAsignatura {
  semestre      Int
  posicion      Int
  caracter      CARACTER
  areaFormacion AREA

  // referencia a

  idPlan Int
  plan   Plan @relation(name: "es contemplada por", fields: [idPlan], references: [id])

  idAsignatura Int
  asignatura   Asignatura @relation(name: "contempla la asignatura", fields: [idAsignatura], references: [id])

  // es referenciado por

  esRequeridaEn            Tributacion[]              @relation(name: "es la requerida")
  esTributadaEn            Tributacion[]              @relation(name: "es la tributada")
  practicaReferenciada     Practica?                  @relation(name: "practica referenciada")
  cursacionTomada          Cursacion[]                @relation(name: "asignatura contemplada")
  LineaContemplaAsignatura LineaContemplaAsignatura[] @relation(name: "referencia a la asigcont")

  //

  @@id([idPlan, idAsignatura])
}

model Tributacion {
  // referencia a 

  idPlan                Int
  idAsignaturaRequerida Int
  idAsignaturaTributada Int

  asignaturaRequerida PlanContemplaAsignatura @relation(name: "es la requerida", fields: [idPlan, idAsignaturaRequerida], references: [idPlan, idAsignatura])
  asignaturaTributada PlanContemplaAsignatura @relation(name: "es la tributada", fields: [idPlan, idAsignaturaTributada], references: [idPlan, idAsignatura])

  //

  @@id([idPlan, idAsignaturaTributada, idAsignaturaRequerida])
}

model LineaAsignatura {
  id Int @default(autoincrement())

  titulo String

  // referencia a

  idPlan           Int
  PlanReferenciado Plan @relation(name: "es definido por", fields: [idPlan], references: [id])

  // es referenciado por

  LineaContemplaAsignatura LineaContemplaAsignatura[] @relation(name: "referencia a la linea")

  //

  @@id([id, idPlan])
  @@unique([idPlan, titulo])
}

model LineaContemplaAsignatura {
  posicion Int

  // referencia a

  idPlan                      Int
  idLinea                     Int
  LineaAsignaturaReferenciada LineaAsignatura @relation(name: "referencia a la linea", fields: [idLinea, idPlan], references: [id, idPlan])

  idAsignatura                      Int
  AsignaturaContempladaReferenciada PlanContemplaAsignatura @relation(name: "referencia a la asigcont", fields: [idPlan, idAsignatura], references: [idPlan, idAsignatura])

  // 

  @@id([posicion, idPlan, idLinea, idAsignatura])
  @@unique([idPlan, idLinea, posicion])
}
